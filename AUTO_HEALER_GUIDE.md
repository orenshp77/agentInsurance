# ğŸ¤– Auto-Healer Bot - ××“×¨×™×š ××§×™×£

## ×¡×§×™×¨×” ×›×œ×œ×™×ª

**Auto-Healer Bot** ×”×•× ×‘×•×˜ ××•×˜×•××˜×™ ×—×›× ×©×¨×¥ ×›×œ 3 ×™××™× ×•××‘×¦×¢:

1. âœ… **×¡×¨×™×§×” ××œ××”** ×©×œ ×”××¢×¨×›×ª (7 ×‘×“×™×§×•×ª)
2. âœ… **×–×™×”×•×™ ×‘×¢×™×•×ª** ××•×˜×•××˜×™
3. âœ… **×ª×™×§×•×Ÿ ×‘××’×™×** ××•×˜×•××˜×™ (×›××©×¨ ×‘×˜×•×—)
4. âœ… **×©×œ×™×—×ª ×“×•×— ×œ××™×™×œ** ×œ-orenshp77@gmail.com

---

## ğŸ“‹ ××” ×”×‘×•×˜ ×‘×•×“×§?

### 1. ğŸ—„ï¸ Database Health
- ×—×™×‘×•×¨ ×œ×“××˜×”×‘×™×™×¡
- ××¡×¤×¨ ×—×™×‘×•×¨×™× ×¤×¢×™×œ×™×
- ×’×•×“×œ ×˜×‘×œ××•×ª
- ×‘×™×¦×•×¢×™ ×©××™×œ×ª×•×ª

### 2. ğŸ”— Orphaned Records
- **×œ×§×•×—×•×ª ×™×ª×•××™×** (×¡×•×›×Ÿ × ××—×§) â†’ **×ª×™×§×•×Ÿ ××•×˜×•××˜×™**
- **×ª×™×§×™×•×ª ×™×ª×•××•×ª** (××©×ª××© × ××—×§) â†’ **×ª×™×§×•×Ÿ ××•×˜×•××˜×™**
- **×§×‘×¦×™× ×™×ª×•××™×** (×ª×™×§×™×™×” × ××—×§×”) â†’ **×ª×™×§×•×Ÿ ××•×˜×•××˜×™**

### 3. ğŸ“ File Integrity
- ×§×‘×¦×™× ×›×¤×•×œ×™×
- ×§×‘×¦×™× ×¢× URLs ×œ× ×ª×§×™× ×™× â†’ **×ª×™×§×•×Ÿ ××•×˜×•××˜×™**
- ×§×‘×¦×™× ×¢× ×©××•×ª ×—×¡×¨×™× â†’ **×ª×™×§×•×Ÿ ××•×˜×•××˜×™**

### 4. ğŸ‘¤ User Accounts
- ××©×ª××©×™× ×œ×œ× ××™×™×œ
- ××™×™×œ×™× ×›×¤×•×œ×™×
- ×”×ª×¨××•×ª ×™×©× ×•×ª (>30 ×™×•×) â†’ **×ª×™×§×•×Ÿ ××•×˜×•××˜×™**

### 5. ğŸ“Š System Logs
- ×©×’×™××•×ª ×§×¨×™×˜×™×•×ª (3 ×™××™× ××—×¨×•× ×™×)
- ×œ×•×’×™× ×™×©× ×™× (>90 ×™×•×) â†’ **×ª×™×§×•×Ÿ ××•×˜×•××˜×™**

### 6. âš¡ Performance
- ×©××™×œ×ª×•×ª ××™×˜×™×•×ª
- ×—×™×‘×•×¨×™× ×ª×§×•×¢×™×

### 7. ğŸ”’ Security
- ××¡×¤×¨ ××©×ª××©×™ Admin
- ×”×¨×©××•×ª ×—×¨×™×’×•×ª

---

## ğŸš€ ×”×ª×§× ×” ×•×”×¤×¢×œ×”

### ×©×œ×‘ 1: ×”×›× ×”

#### ×. ×¦×•×¨ Gmail App Password

1. ×œ×š ×œ-https://myaccount.google.com/apppasswords
2. ×”×ª×—×‘×¨ ×¢× ×—×©×‘×•×Ÿ Gmail ×©×œ×š
3. ×¦×•×¨ **App Password** ×—×“×©
4. ×ª×Ÿ ×œ×• ×©×: "Auto-Healer Bot"
5. ×©××•×¨ ××ª ×”×¡×™×¡××” (16 ×ª×•×•×™×)

#### ×‘. ×”×›×Ÿ ××ª ×”×¡×‘×™×‘×”

```powershell
# ×”×ª×§×Ÿ dependencies
cd my-agent-app
npm install nodemailer @types/nodemailer

# ×”×›×Ÿ ××ª cloud-functions
cd cloud-functions/auto-healer
npm install
```

---

### ×©×œ×‘ 2: ×‘×“×™×§×” ××§×•××™×ª (×©×œ×™×—×ª ××™×™×œ ×œ×“×•×’××”)

```powershell
# ×”×’×“×¨ ××©×ª× ×™×
$env:GMAIL_USER = "your-email@gmail.com"
$env:GMAIL_APP_PASSWORD = "your-16-char-password"

# ×©×œ×— ××™×™×œ ×‘×“×™×§×”
npx tsx scripts/test-email.ts
```

**×ª×•×¦××” ×¦×¤×•×™×”:**
```
âœ… ××™×™×œ × ×©×œ×— ×‘×”×¦×œ×—×”!

ğŸ“§ ×¤×¨×˜×™ ×”××™×™×œ:
   ×××ª: your-email@gmail.com
   ××œ: orenshp77@gmail.com
   Message ID: <...>

ğŸ‰ ×‘×“×•×§ ××ª ×ª×™×‘×ª ×”×“×•××¨ ×©×œ×š!
```

---

### ×©×œ×‘ 3: ×”×¢×œ××” ×œ-Google Cloud

```powershell
# ×”×¨×¥ ××ª ×¡×§×¨×™×¤×˜ ×”×”×¢×œ××”
.\scripts\deploy-auto-healer.ps1
```

×”×¡×§×¨×™×¤×˜ ×™×‘×¦×¢:
1. âœ… ×”×’×“×¨×ª Google Cloud project
2. âœ… ×”×¤×¢×œ×ª APIs × ×“×¨×©×™×
3. âœ… ×”×¢×œ××ª Cloud Function
4. âœ… ×”×’×“×¨×ª Cloud Scheduler (×›×œ 3 ×™××™×)
5. âœ… ×‘×“×™×§×” ×•×©×œ×™×—×ª ××™×™×œ ×¨××©×•×Ÿ

---

### ×©×œ×‘ 4: ××™×©×•×¨ ×”×¦×œ×—×”

×‘×“×•×§ ××ª ×”××™×™×œ ×©×œ×š (`orenshp77@gmail.com`). ×××•×¨ ×œ×”×’×™×¢ ××™×™×œ ×‘×“×™×§×” ×©× ×¨××” ×›×š:

```
× ×•×©×: ğŸ§ª [×‘×“×™×§×”] ×“×•×— ×¡×¨×™×§×” ××•×˜×•××˜×™×ª - insurance-app

×ª×•×›×Ÿ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   âš ï¸                                â”‚
â”‚   ×“×•×— ×¡×¨×™×§×” ××•×˜×•××˜×™×ª - insurance-app  â”‚
â”‚   ğŸ§ª ×–×”×• ××™×™×œ ×‘×“×™×§×” - ×”×‘×•×˜ ×¢×•×‘×“!    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“Š ×¡×™×›×•×
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   7    â”‚   5    â”‚   3    â”‚   2    â”‚
â”‚ ×‘×“×™×§×•×ª â”‚ ×‘×¢×™×•×ª  â”‚ ×ª×•×§× ×•  â”‚ ×™×“× ×™   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… ×ª×•×§×Ÿ ××•×˜×•××˜×™×ª:
- Data Integrity: × ××¦××• 3 ×œ×§×•×—×•×ª ×™×ª×•××™×
- Data Cleanup: × ××¦××• 152 ×”×ª×¨××•×ª ×™×©× ×•×ª
- Data Cleanup: × ××¦××• 1,234 ×œ×•×’×™× ×™×©× ×™×

âš ï¸ ×“×•×¨×© ×˜×™×¤×•×œ ×™×“× ×™:
- Database: ×’× ×¨×‘ ×—×™×‘×•×¨×™× ×¤×¢×™×œ×™×: 52
- Security: ×™×•×ª×¨ ××“×™ ××©×ª××©×™ Admin: 6
```

---

## ğŸ“… ×œ×•×— ×–×× ×™×

×”×‘×•×˜ ×¨×¥ ××•×˜×•××˜×™×ª:
- **×ª×“×™×¨×•×ª:** ×›×œ 3 ×™××™×
- **×©×¢×”:** 3:00 ×‘×‘×•×§×¨
- **××–×•×¨ ×–××Ÿ:** Asia/Jerusalem
- **×‘×™×¦×•×¢:** Cloud Scheduler â†’ Cloud Function

---

## ğŸ› ï¸ ×¤×¢×•×œ×•×ª × ×¤×•×¦×•×ª

### ×”×¨×¦×” ×™×“× ×™×ª (×œ× ×œ×—×›×•×ª 3 ×™××™×)

```bash
# ×”×¤×¢×œ×” ××™×™×“×™×ª
gcloud scheduler jobs run auto-healer-schedule --location=us-central1
```

### ×¦×¤×™×™×” ×‘×œ×•×’×™×

```bash
# ×œ×•×’×™× ×©×œ ×”-function
gcloud functions logs read auto-healer-bot \
  --gen2 \
  --region=us-central1 \
  --limit=50

# ×œ×•×’×™× ×©×œ ×”-scheduler
gcloud logging read "resource.type=cloud_scheduler_job" \
  --limit=50
```

### ×‘×“×™×§×ª ×¡×˜×˜×•×¡

```bash
# ×¡×˜×˜×•×¡ ×©×œ ×”-function
gcloud functions describe auto-healer-bot \
  --gen2 \
  --region=us-central1

# ×¡×˜×˜×•×¡ ×©×œ ×”-scheduler
gcloud scheduler jobs describe auto-healer-schedule \
  --location=us-central1
```

### ×¢×“×›×•×Ÿ ×”×‘×•×˜ (××—×¨×™ ×©×™× ×•×™×™× ×‘×§×•×“)

```powershell
cd cloud-functions/auto-healer

# ×”×¢×œ××” ××—×“×©
gcloud functions deploy auto-healer-bot \
  --gen2 \
  --runtime=nodejs20 \
  --region=us-central1 \
  --source=. \
  --entry-point=autoHealerBot \
  --trigger-http \
  --timeout=540s \
  --memory=512MB \
  --no-allow-unauthenticated
```

### ××—×™×§×ª ×”×‘×•×˜ (×× ×¦×¨×™×š)

```bash
# ××—×§ ××ª ×”-function
gcloud functions delete auto-healer-bot \
  --gen2 \
  --region=us-central1

# ××—×§ ××ª ×”-scheduler
gcloud scheduler jobs delete auto-healer-schedule \
  --location=us-central1

# ××—×§ service account
gcloud iam service-accounts delete \
  auto-healer-invoker@insurance-app-486316.iam.gserviceaccount.com
```

---

## ğŸ¨ ×“×•×’××ª ××™×™×œ ×××™×ª×™

×›×©×”×‘×•×˜ ×™××¦× ×‘×¢×™×•×ª ×××™×ª×™×•×ª, ×”××™×™×œ ×™×›×œ×•×œ:

### ××§×¨×” 1: ×”×›×œ ×ª×§×™×Ÿ âœ…

```
× ×•×©×: âœ… ×“×•×— ×¡×¨×™×§×” ××•×˜×•××˜×™×ª - insurance-app

ğŸ“Š ×¡×™×›×•×
7 ×‘×“×™×§×•×ª | 0 ×‘×¢×™×•×ª | 0 ×ª×•×§× ×• | 0 ×™×“× ×™

ğŸ‰ ×›×¨×’×¢ ×”×›×œ ×ª×§×™×Ÿ!
×œ× × ××¦××• ×‘×¢×™×•×ª ×‘××¢×¨×›×ª. ×”××¢×¨×›×ª ×¤×•×¢×œ×ª ×›×©×•×¨×”.
```

### ××§×¨×” 2: ×‘×¢×™×•×ª ×§×˜× ×•×ª ×©×ª×•×§× ×• âš ï¸

```
× ×•×©×: âš ï¸ ×“×•×— ×¡×¨×™×§×” ××•×˜×•××˜×™×ª - insurance-app

ğŸ“Š ×¡×™×›×•×
7 ×‘×“×™×§×•×ª | 3 ×‘×¢×™×•×ª | 3 ×ª×•×§× ×• | 0 ×™×“× ×™

âœ… ×ª×•×§×Ÿ ××•×˜×•××˜×™×ª:
- Data Integrity: × ××¦××• 2 ×œ×§×•×—×•×ª ×™×ª×•××™× (×”×¡×•×›×Ÿ × ××—×§)
  ğŸ“ User table

- Data Cleanup: × ××¦××• 48 ×”×ª×¨××•×ª ×™×©× ×•×ª (>30 ×™×•×)
  ğŸ“ Notification table

- File System: × ××¦××• 5 ×§×‘×¦×™× ×¢× × ×ª×•× ×™× ×œ× ×ª×§×™× ×™×
  ğŸ“ File table

ğŸ‰ ×›×¨×’×¢ ×”×›×œ ×ª×§×™×Ÿ!
×›×œ ×”×‘×¢×™×•×ª ×ª×•×§× ×• ××•×˜×•××˜×™×ª.
```

### ××§×¨×” 3: ×‘×¢×™×•×ª ×§×¨×™×˜×™×•×ª! ğŸš¨

```
× ×•×©×: ğŸš¨ ×“×•×— ×¡×¨×™×§×” ××•×˜×•××˜×™×ª - insurance-app

ğŸ“Š ×¡×™×›×•×
7 ×‘×“×™×§×•×ª | 5 ×‘×¢×™×•×ª | 2 ×ª×•×§× ×• | 3 ×™×“× ×™

âœ… ×ª×•×§×Ÿ ××•×˜×•××˜×™×ª:
- Data Cleanup: × ××¦××• 200 ×”×ª×¨××•×ª ×™×©× ×•×ª
- Data Cleanup: × ××¦××• 3,456 ×œ×•×’×™× ×™×©× ×™×

âš ï¸ ×“×•×¨×© ×˜×™×¤×•×œ ×™×“× ×™:
â— Database: ×©×’×™××” ×‘×—×™×‘×•×¨ ×œ×“××˜×”×‘×™×™×¡
  ğŸ“ Database Connection
  ğŸ”´ ×¨××ª ×—×•××¨×”: critical

â— System Logs: × ××¦××• 15 ×©×’×™××•×ª ×§×¨×™×˜×™×•×ª ×‘-3 ×”×™××™× ×”××—×¨×•× ×™×
  ğŸ“ Log table
  ğŸ”´ ×¨××ª ×—×•××¨×”: critical

â— Security: ××™×Ÿ ××©×ª××©×™ Admin ×‘××¢×¨×›×ª!
  ğŸ“ User table
  ğŸ”´ ×¨××ª ×—×•××¨×”: critical

âš ï¸ × ×“×¨×© ×˜×™×¤×•×œ ×“×—×•×£!
```

---

## ğŸ”’ ××‘×˜×—×”

### ××” ×”×‘×•×˜ ××ª×§×Ÿ ××•×˜×•××˜×™×ª?

×”×‘×•×˜ **×¨×§** ××ª×§×Ÿ ×“×‘×¨×™× ×‘×˜×•×—×™×:
- âœ… ××—×™×§×ª ×¨×©×•××•×ª ×™×ª×•××•×ª
- âœ… × ×™×§×•×™ ×”×ª×¨××•×ª ×™×©× ×•×ª
- âœ… × ×™×§×•×™ ×œ×•×’×™× ×™×©× ×™×
- âœ… ××—×™×§×ª ×§×‘×¦×™× ×œ× ×ª×§×™× ×™×

### ××” ×”×‘×•×˜ **×œ×** ××ª×§×Ÿ?

×”×‘×•×˜ **×œ×¢×•×œ× ×œ×** ×™×ª×§×Ÿ:
- âŒ ×‘×¢×™×•×ª ×“××˜×”×‘×™×™×¡ ×§×¨×™×˜×™×•×ª
- âŒ ×©×’×™××•×ª ×—×™×‘×•×¨
- âŒ ××—×™×§×ª ××©×ª××©×™×
- âŒ ×©×™× ×•×™ ×”×¨×©××•×ª
- âŒ ×¢×“×›×•×Ÿ ×¡×™×¡×××•×ª

**×›×œ ×‘×¢×™×” ×§×¨×™×˜×™×ª ×ª×™×©×œ×— ×œ××™×™×œ ×œ×˜×™×¤×•×œ ×™×“× ×™!**

---

## ğŸ“Š ××¢×§×‘ ×•× ×™×˜×•×¨

### Dashboard ×‘-Google Cloud

1. ×œ×š ×œ-[Google Cloud Console](https://console.cloud.google.com)
2. × ×•×•×˜ ×œ-**Cloud Functions**
3. ×œ×—×¥ ×¢×œ `auto-healer-bot`
4. ×¦×¤×” ×‘:
   - Metrics (invocations, errors, duration)
   - Logs
   - Permissions

### ×”×ª×¨××•×ª

×”×’×“×¨ alerting ×‘-Cloud Monitoring:

```bash
# ×”×ª×¨××” ×¢×œ ×›×©×œ×•×Ÿ ×”×‘×•×˜
gcloud alpha monitoring policies create \
  --notification-channels=CHANNEL_ID \
  --display-name="Auto-Healer Bot Failed" \
  --condition-display-name="Function Errors" \
  --condition-threshold-value=1 \
  --condition-threshold-duration=60s
```

---

## ğŸ› ×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª

### ×‘×¢×™×”: ×”××™×™×œ ×œ× ××’×™×¢

**×¤×ª×¨×•×Ÿ:**
1. ×‘×“×•×§ spam folder
2. ×‘×“×•×§ ×©×”-App Password × ×›×•×Ÿ
3. ×‘×“×•×§ ×œ×•×’×™×:
   ```bash
   gcloud functions logs read auto-healer-bot --limit=50
   ```
4. ×”×¨×¥ ×©×•×‘ ×™×“× ×™×ª:
   ```bash
   gcloud scheduler jobs run auto-healer-schedule --location=us-central1
   ```

### ×‘×¢×™×”: ×”×‘×•×˜ × ×›×©×œ

**×¤×ª×¨×•×Ÿ:**
1. ×¦×¤×” ×‘×œ×•×’×™×
2. ×‘×“×•×§ environment variables
3. ×‘×“×•×§ database connection
4. ×”×¨×¥ ××ª ×”×‘×“×™×§×” ×”××§×•××™×ª:
   ```bash
   npx tsx scripts/test-email.ts
   ```

### ×‘×¢×™×”: ×”×‘×•×˜ ×œ× ×¨×¥ ×›×œ 3 ×™××™×

**×¤×ª×¨×•×Ÿ:**
1. ×‘×“×•×§ Cloud Scheduler:
   ```bash
   gcloud scheduler jobs describe auto-healer-schedule --location=us-central1
   ```
2. ×‘×“×•×§ ×”×× ×”-job ××•×¤×¢×œ (enabled):
   ```bash
   gcloud scheduler jobs list --location=us-central1
   ```
3. ×× disabled, ×”×¤×¢×œ:
   ```bash
   gcloud scheduler jobs resume auto-healer-schedule --location=us-central1
   ```

---

## ğŸ’° ×¢×œ×•×™×•×ª

### ×”×¢×¨×›×ª ×¢×œ×•×™×•×ª ×—×•×“×©×™×•×ª:

| ×©×™×¨×•×ª | ×©×™××•×© | ×¢×œ×•×ª ××©×•×¢×¨×ª |
|-------|-------|-------------|
| Cloud Functions | 10 ×”×¨×¦×•×ª/×—×•×“×© Ã— 30 ×©× ×™×•×ª | $0.01 |
| Cloud Scheduler | 1 job | $0.10 |
| Gmail API | Free | $0.00 |
| **×¡×”"×›** | | **~$0.11/×—×•×“×©** |

**×›××¢×˜ ×‘×—×™× ×!** ğŸ’š

---

## ğŸ“š ×§×‘×¦×™×

| ×§×•×‘×¥ | ×ª×™××•×¨ |
|------|-------|
| [cloud-functions/auto-healer/index.ts](cloud-functions/auto-healer/index.ts) | ×”×‘×•×˜ ×¢×¦××• - ×›×œ ×”×œ×•×’×™×§×” |
| [cloud-functions/auto-healer/package.json](cloud-functions/auto-healer/package.json) | Dependencies |
| [scripts/deploy-auto-healer.ps1](scripts/deploy-auto-healer.ps1) | ×¡×§×¨×™×¤×˜ deployment |
| [scripts/test-email.ts](scripts/test-email.ts) | ×‘×“×™×§×” ××§×•××™×ª |
| [AUTO_HEALER_GUIDE.md](AUTO_HEALER_GUIDE.md) | ×”××“×¨×™×š ×”×–×” |

---

## ğŸ¯ ×¡×™×›×•×

### âœ… ××” ×™×© ×œ×š ×¢×›×©×™×•:

1. ğŸ¤– **×‘×•×˜ ××•×˜×•××˜×™** ×©×¨×¥ ×›×œ 3 ×™××™×
2. ğŸ“§ **××™×™×œ×™× ××•×˜×•××˜×™×™×** ×œ-orenshp77@gmail.com
3. ğŸ”§ **×ª×™×§×•×Ÿ ××•×˜×•××˜×™** ×©×œ ×‘×¢×™×•×ª × ×¤×•×¦×•×ª
4. ğŸš¨ **×”×ª×¨××•×ª** ×¢×œ ×‘×¢×™×•×ª ×§×¨×™×˜×™×•×ª
5. ğŸ“Š **×“×•×—×•×ª ××¤×•×¨×˜×™×** ×¢× ×¡×˜×˜×™×¡×˜×™×§×•×ª
6. ğŸ’° **×›××¢×˜ ×‘×—×™× ×** (~$0.11/×—×•×“×©)

### ğŸš€ ××” ×”×œ××”?

1. âœ… ×”×¨×¥ ××ª ×”×‘×“×™×§×” ×”××§×•××™×ª
2. âœ… ×”×¢×œ×” ×œ-Google Cloud
3. âœ… ×§×‘×œ ××™×™×œ ×¨××©×•×Ÿ
4. âœ… ×”×—×›×” 3 ×™××™× ×œ××™×™×œ ×××™×ª×™

---

**ğŸ‰ ×”××¢×¨×›×ª ×©×œ×š ×¢×›×©×™×• self-healing!**

×”×‘×•×˜ ×™×“××’ ×œ× ×™×§×™×•×Ÿ, ×ª×™×§×•×Ÿ ×‘×¢×™×•×ª, ×•×™×ª×¨×™×¢ ×¢×œ×™×š ×¨×§ ×›×©×¦×¨×™×š.

**×ª×™×”× ×” ××©×§×˜ × ×¤×©×™! ğŸ§˜â€â™‚ï¸**

---

**×ª××¨×™×š ×™×¦×™×¨×”:** 2026-02-07
**×’×¨×¡×”:** 1.0.0
**×¡×˜×˜×•×¡:** âœ… PRODUCTION READY
